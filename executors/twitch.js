(()=>{function k(k,E,D,r,n=null){try{document.location.host;let x="detector",L=D;!L&&n&&(L=n[0]?.type?n[0].type:null);let Q={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"VIDEO_XHR_CANDIDATE",from:x,to:x.substring(0,x.length-2),content:{requestMethod:k,url:E,type:L,content:r}};if(n&&n instanceof Promise)return void n.then((k=>{Q.content.encodedPostBody=k,Q.type="VIDEO_TWITCH_INSTREAM_DATA",window.postMessage(Q,"*")}));r?.includes("streamPlaybackAccessToken")&&(Q.type="VIDEO_TWITCH_INSTREAM_DATA"),window.postMessage(Q,"*")}catch(k){}}let E=XMLHttpRequest.prototype.open,D=XMLHttpRequest.prototype.send,r=fetch;XMLHttpRequest.prototype.open=function(){this.requestMethod=arguments[0],E.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){const E=Object.assign(arguments,{});let r=this.onreadystatechange;return this.onreadystatechange=function(){if(4!==this.readyState||function(k){const E=document.querySelector("script[data-bis-config]")?JSON.parse(document.querySelector("script[data-bis-config]").getAttribute("data-bis-config")):null;return!!E&&E.some((E=>k.includes(E)))}(this.responseURL)||k(this.requestMethod,this.responseURL,this.getResponseHeader("content-type"),this.response,E),r)return r.apply(this,arguments)},D.apply(this,arguments)},fetch=function(){const E=arguments;let D=arguments[0]instanceof Request?arguments[0].url:arguments[0];const n=arguments[0]instanceof Request?arguments[0].method:arguments[1]?.method?arguments[1].method:"GET",x="POST"===n?arguments[1].body:null;return"object"==typeof D&&D.href&&(D=D.href),new Promise(((L,Q)=>{r.apply(this,E).then((function(E){if(E.body instanceof ReadableStream){const r=E.headers.get("content-type"),L=E.json;E.json=function(){return new Promise(((Q,M)=>{L.apply(this,arguments).then((function(L){0!==E.url.search(/data:application\/json;base64/)&&k(n,D,r,JSON.stringify(L),x),Q(L)})).catch((function(k){M(k)}))}))};const Q=E.text;E.text=function(){return new Promise(((L,M)=>{Q.apply(this,arguments).then((function(Q){0!==E.url.search(/data:application\/json;base64/)&&k(n,D,r,Q,x),L(Q)})).catch((function(k){M(k)}))}))},new RegExp("video-edge.*.ts$").test(D)&&"POST"===n&&x?.arrayBuffer&&k(n,D,x.type,null,x.text())}L.apply(this,arguments)})).catch((function(k){Q.apply(this,arguments)}))}))}})();